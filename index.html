<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Beloved</title>
    <link href="https://fonts.googleapis.com/css2?family=Parisienne&family=Lora:wght@400;500;700&family=Cormorant+Garamond:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #8b5a2b;
            --accent-color: #d1a080;
            --text-color: #5a4a42;
            --bg-color: #f8f3e9;
            --light-color: #fff9f0;
        }

        body {
            font-family: 'Cormorant Garamond', serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.8;
            overflow-x: hidden;
            position: relative;
            cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23d1a080'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E") 12 12, auto;
        }

        /* Decorative Elements */
        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.5;
        }

        .heart {
            position: absolute;
            width: 15px;
            height: 15px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23d1a080' stroke='none'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E") no-repeat center center;
            opacity: 0;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-1000%) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Gradient Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at top right, rgba(255, 240, 230, 0.8), transparent 40%),
                radial-gradient(circle at bottom left, rgba(255, 225, 210, 0.6), transparent 30%);
            z-index: -1;
            pointer-events: none;
        }

        /* Main Container */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 60px 30px;
        }

        /* Typography */
        h1 {
            font-family: 'Parisienne', cursive;
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 40px;
            text-shadow: 2px 2px 10px rgba(139, 90, 43, 0.15);
            position: relative;
        }

        h1::after {
            content: "";
            position: absolute;
            width: 120px;
            height: 3px;
            background: linear-gradient(to right, transparent, var(--accent-color), transparent);
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
        }

        h2 {
            font-family: 'Parisienne', cursive;
            font-size: 2.2rem;
            color: var(--accent-color);
            margin-bottom: 25px;
            position: relative;
        }

        h2::after {
            content: "";
            position: absolute;
            width: 50px;
            height: 2px;
            background: linear-gradient(to right, transparent, var(--accent-color), transparent);
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
        }

        /* Animations */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 1.2s ease-out forwards;
        }

        .fade-in:nth-child(2) { animation-delay: 0.2s; }
        .fade-in:nth-child(3) { animation-delay: 0.4s; }
        .fade-in:nth-child(4) { animation-delay: 0.6s; }
        .fade-in:nth-child(5) { animation-delay: 0.8s; }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Card Styles */
        .card {
            background: var(--light-color);
            padding: 35px;
            margin: 30px 0;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(139, 90, 43, 0.08);
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(139, 90, 43, 0.12);
        }

        .card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, transparent, var(--accent-color), transparent);
        }

        /* Love Letter Section */
        .love-letter {
            font-family: 'Lora', serif;
        }

        .letter-text {
            font-size: 1.3rem;
            margin: 15px 0;
            line-height: 1.8;
            transition: all 0.3s ease;
            position: relative;
        }

        .letter-signature {
            font-family: 'Parisienne', cursive;
            font-size: 1.8rem;
            margin-top: 30px;
            color: var(--primary-color);
        }

        /* Music Player */
        .music-player {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50px;
            padding: 15px 20px;
            box-shadow: 0 10px 30px rgba(139, 90, 43, 0.2);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .music-player:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(139, 90, 43, 0.3);
        }

        .music-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .music-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .music-btn:hover {
            background: var(--accent-color);
            transform: scale(1.1);
        }

        .music-info {
            font-family: 'Lora', serif;
            font-size: 0.9rem;
            color: var(--primary-color);
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Gallery Section */
        .gallery {
            overflow: visible;
        }

        .photo-carousel {
            position: relative;
            display: flex;
            gap: 25px;
            padding: 15px 0 25px;
            overflow-x: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-color) var(--light-color);
            scroll-behavior: smooth;
        }

        .photo-carousel::-webkit-scrollbar {
            height: 8px;
        }

        .photo-carousel::-webkit-scrollbar-track {
            background: var(--light-color);
            border-radius: 10px;
        }

        .photo-carousel::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 10px;
        }

        .photo-container {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            flex: 0 0 auto;
            width: 350px;
            height: 230px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
        }

        .photo-container:hover {
            transform: scale(1.05) translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 2s ease;
        }

        .photo-container:hover .photo {
            transform: scale(1.1);
        }

        .photo-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 15px;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
            color: white;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            font-family: 'Lora', serif;
        }

        .photo-container:hover .photo-caption {
            transform: translateY(0);
        }

        /* Timeline Section */
        .timeline {
            position: relative;
            padding: 40px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, var(--accent-color), var(--primary-color));
            transform: translateX(-50%);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 40px;
            width: 45%;
        }

        .timeline-item:nth-child(odd) {
            left: 0;
            text-align: right;
            padding-right: 40px;
        }

        .timeline-item:nth-child(even) {
            left: 55%;
            text-align: left;
            padding-left: 40px;
        }

        .timeline-content {
            background: var(--light-color);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(139, 90, 43, 0.1);
            position: relative;
            transition: all 0.3s ease;
        }

        .timeline-content:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(139, 90, 43, 0.2);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--primary-color);
            border-radius: 50%;
            top: 20px;
            border: 4px solid var(--light-color);
            box-shadow: 0 0 0 3px var(--accent-color);
        }

        .timeline-item:nth-child(odd)::before {
            right: -10px;
        }

        .timeline-item:nth-child(even)::before {
            left: -10px;
        }

        .timeline-date {
            font-family: 'Parisienne', cursive;
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .timeline-title {
            font-family: 'Lora', serif;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }

        .timeline-description {
            font-size: 0.95rem;
            line-height: 1.6;
            color: var(--text-color);
        }

        /* Love Quiz Section */
        .love-quiz {
            text-align: center;
        }

        .quiz-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .quiz-question {
            background: var(--light-color);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 20px rgba(139, 90, 43, 0.1);
            display: none;
        }

        .quiz-question.active {
            display: block;
            animation: fadeInUp 0.5s ease-out;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .quiz-option {
            background: white;
            border: 2px solid var(--accent-color);
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Lora', serif;
        }

        .quiz-option:hover {
            background: var(--accent-color);
            color: white;
            transform: translateY(-3px);
        }

        .quiz-option.correct {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .quiz-option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .quiz-result {
            background: var(--light-color);
            padding: 30px;
            border-radius: 20px;
            margin-top: 20px;
            display: none;
        }

        .quiz-result.show {
            display: block;
            animation: fadeInUp 0.5s ease-out;
        }

        /* Floating Messages */
        .floating-message {
            position: fixed;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(139, 90, 43, 0.2);
            font-family: 'Lora', serif;
            color: var(--primary-color);
            z-index: 1000;
            pointer-events: none;
            animation: floatMessage 4s ease-in-out forwards;
        }

        @keyframes floatMessage {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.8);
            }
            20% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            80% {
                opacity: 1;
                transform: translateY(-20px) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-40px) scale(0.8);
            }
        }

        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--accent-color);
            z-index: 999;
            pointer-events: none;
            animation: confettiFall 3s linear forwards;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Firebase Sections */
        .firebase-section {
            margin-top: 40px;
        }

        .letter-archive {
            max-height: 500px;
            overflow-y: auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            margin-top: 20px;
        }

        .archive-letter {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(139, 90, 43, 0.1);
            transition: all 0.3s ease;
            border-left: 4px solid var(--accent-color);
        }

        .archive-letter:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(139, 90, 43, 0.15);
        }

        .archive-letter-title {
            font-family: 'Parisienne', cursive;
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .archive-letter-date {
            font-size: 0.9rem;
            color: var(--accent-color);
            margin-bottom: 15px;
            font-style: italic;
        }

        .archive-letter-message {
            font-family: 'Lora', serif;
            line-height: 1.7;
            color: var(--text-color);
            white-space: pre-line;
        }

        .quiz-scores {
            max-height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            margin-top: 20px;
        }

        .score-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(139, 90, 43, 0.1);
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary-color);
        }

        .score-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(139, 90, 43, 0.15);
        }

        .score-date {
            font-size: 0.9rem;
            color: var(--accent-color);
            margin-bottom: 8px;
        }

        .score-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .score-message {
            font-size: 0.95rem;
            color: var(--text-color);
            font-style: italic;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--accent-color);
            font-style: italic;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: var(--accent-color);
            font-style: italic;
        }

        /* Add Letter Form */
        .add-letter-form {
            background: var(--light-color);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(139, 90, 43, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-family: 'Lora', serif;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--accent-color);
            border-radius: 10px;
            font-family: 'Lora', serif;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            box-shadow: 0 0 10px rgba(209, 160, 128, 0.3);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-submit {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            font-family: 'Lora', serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .form-submit:hover {
            background: var(--accent-color);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(209, 160, 128, 0.3);
        }

        .form-submit:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Delete Button Styles */
        .delete-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 12px;
        }

        .delete-btn:hover {
            background: #ff4757;
            transform: scale(1.1);
        }

        .archive-letter {
            position: relative;
        }

        .score-item {
            position: relative;
        }

        /* Open When Letters Section */
        .open-when-section {
            text-align: center;
        }

        .open-when-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .open-when-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            border: none;
            border-radius: 15px;
            padding: 20px;
            font-family: 'Lora', serif;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(139, 90, 43, 0.2);
            position: relative;
            overflow: hidden;
        }

        .open-when-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(139, 90, 43, 0.3);
        }

        .open-when-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .open-when-btn:hover::before {
            left: 100%;
        }

        .open-when-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .open-when-content {
            background: var(--light-color);
            margin: 5% auto;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2rem;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            color: var(--accent-color);
            transform: scale(1.1);
        }

        .open-when-title {
            font-family: 'Parisienne', cursive;
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .open-when-message {
            font-family: 'Lora', serif;
            font-size: 1.2rem;
            line-height: 1.8;
            color: var(--text-color);
            margin-bottom: 30px;
            white-space: pre-line;
        }



        /* Playlist Section */
        .playlist {
            position: relative;
        }

        .playlist-notes {
            position: absolute;
            width: 50px;
            height: 50px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23d1a080' opacity='0.3'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z'/%3E%3C/svg%3E");
            pointer-events: none;
        }

        /* Countdown Section */
        .countdown {
            text-align: center;
        }

        .timer-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .timer-item {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: white;
            border-radius: 12px;
            width: 90px;
            height: 90px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 20px rgba(139, 90, 43, 0.2);
        }

        .timer-value {
            font-size: 2.2rem;
            font-weight: 600;
            line-height: 1;
        }

        .timer-label {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
            margin-top: 5px;
        }

        /* Message Board */
        .message-board {
            margin-top: 40px;
        }

        .message-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 15px;
        }

        .message {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            position: relative;
        }

        .message-time {
            font-size: 0.8rem;
            color: #999;
            margin-top: 8px;
        }

        .message-form {
            display: flex;
            gap: 10px;
        }

        .message-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid var(--accent-color);
            border-radius: 25px;
            font-family: 'Lora', serif;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .message-input:focus {
            box-shadow: 0 0 10px rgba(209, 160, 128, 0.3);
        }

        .message-submit {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 25px;
            font-family: 'Lora', serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .message-submit:hover {
            background: var(--accent-color);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(209, 160, 128, 0.3);
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid rgba(139, 90, 43, 0.1);
            font-size: 0.9rem;
            color: var(--accent-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            h1 {
                font-size: 3rem;
            }

            h2 {
                font-size: 1.8rem;
            }

            .card {
                padding: 25px;
            }

            .letter-text {
                font-size: 1.1rem;
            }

            .timer-container {
                flex-wrap: wrap;
            }

            .timer-item {
                width: 70px;
                height: 70px;
            }

            .timer-value {
                font-size: 1.8rem;
            }

            .timeline::before {
                left: 20px;
            }

            .timeline-item {
                width: 100%;
                left: 0 !important;
                text-align: left !important;
                padding-left: 50px !important;
                padding-right: 0 !important;
            }

            .timeline-item::before {
                left: 10px !important;
                right: auto !important;
            }

            .music-player {
                top: 10px;
                right: 10px;
                padding: 10px 15px;
            }

            .music-info {
                max-width: 100px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
            }

            h1 {
                font-size: 2.5rem;
            }

            .photo-container {
                width: 280px;
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <div class="floating-hearts" id="hearts-container"></div>
    
    <!-- Music Player -->
    <div class="music-player" id="music-player">
        <div class="music-controls">
            <button class="music-btn" id="play-pause-btn">
                <i class="fas fa-play" id="play-icon"></i>
            </button>
            <div class="music-info" id="music-info">Click to play our song ❤️</div>
        </div>
    </div>
    
    <div class="container">
        <h1 class="fade-in">For My Beloved ❤️</h1>
        
        <!-- Love Letter Section -->
        <section class="card love-letter fade-in">
            <h2>My Love Letter to You</h2>
            <p class="letter-text">My Dearest, Pookie </p>
            <p class="letter-text">It's been exactly one month since we began this beautiful journey together, and I'm amazed at how much joy and warmth you've brought into my life. Every moment with you feels like a special gift - our laughs, our conversations, even our quiet moments together.</p>
            <p class="letter-text">You've shown me what it means to care deeply for someone, and I'm grateful for every smile, every touch, and every memory we've created. I look forward to many more monthsaries, celebrating our love as it grows stronger each day.</p>
            <p class="letter-text">I wake up each day and thank God for giving me a person like you, and I aspire to become a better partner for you each day. Hold on to me and I'll give you the future we both want. Thank you for being you - for your kindness, your understanding, your appreciation, and the way you make my heart skip a beat when you smile.</p>
            <p class="letter-signature">With all my love,<br>James</p>
        </section>

        <!-- Our Timeline Section -->
        <section class="card timeline fade-in">
            <h2>Our Beautiful Journey Together</h2>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-content">
                        <div class="timeline-date">February 7, 2025</div>
                        <div class="timeline-title">Our First Monthsary</div>
                        <div class="timeline-description">One month of love, growth, and countless memories. Here's to many more!</div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <div class="timeline-date">March 7, 2025</div>
                        <div class="timeline-title">Two Months of Love</div>
                        <div class="timeline-description">Two months of growing stronger together, learning more about each other every day.</div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <div class="timeline-date">April 7, 2025</div>
                        <div class="timeline-title">Three Months Together</div>
                        <div class="timeline-description">Three months of shared adventures, laughter, and deepening our connection.</div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <div class="timeline-date">May 7, 2025</div>
                        <div class="timeline-title">Four Months of Bliss</div>
                        <div class="timeline-description">Four months of beautiful moments, understanding each other more deeply.</div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <div class="timeline-date">June 7, 2025</div>
                        <div class="timeline-title">Five Months Strong</div>
                        <div class="timeline-description">Five months of building our love story, creating memories that will last forever.</div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <div class="timeline-date">July 7, 2025</div>
                        <div class="timeline-title">Six Months of Love</div>
                        <div class="timeline-description">Half a year of pure happiness, love, and growing together as a couple.</div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Gallery Section -->
        <section class="card gallery fade-in">
            <h2>Our Beautiful Memories</h2>
            <div class="photo-carousel">
                <div class="photo-container">
                    <img src="lovey1.jpg" alt="Jabee Date" class="photo">
                    <div class="photo-caption">Jabee Date ❤️</div>
                </div>
                <div class="photo-container">
                    <img src="lovey2.jpg" alt="Sunday Mass" class="photo">
                    <div class="photo-caption">Sunday Mass</div>
                </div>
                <div class="photo-container">
                    <img src="lovey3.jpg" alt="Movie Night" class="photo">
                    <div class="photo-caption">Movie Night</div>
                </div>
                <div class="photo-container">
                    <img src="lovey4.jpg" alt="Inuman Nights" class="photo">
                    <div class="photo-caption">Inuman Nights</div>
                </div>
                <div class="photo-container">
                    <img src="lovey5.jpg" alt="Inuman Nights" class="photo">
                    <div class="photo-caption">Lagtok Selfie</div>
                </div>
                <div class="photo-container">
                    <img src="lovey6.jpg" alt="Inuman Nights" class="photo">
                    <div class="photo-caption">Kinan anay</div>
                </div>
                <div class="photo-container">
                    <img src="lovey7.jpg" alt="Inuman Nights" class="photo">
                    <div class="photo-caption">Mansilingan Jeep</div>
                </div>
                <div class="photo-container">
                    <img src="lovey8.jpg" alt="Inuman Nights" class="photo">
                    <div class="photo-caption">Valentines</div>
                </div>
                <div class="photo-container">
                    <img src="lovey9.jpg" alt="Inuman Nights" class="photo">
                    <div class="photo-caption">Escalator date date</div>
                </div>
                <div class="photo-container">
                    <img src="lovey10.jpg" alt="Inuman Nights" class="photo">
                    <div class="photo-caption">Nominom ah</div>
                </div>
                <div class="photo-container">
                    <img src="bdaybaby.jpg" alt="Birthday Baby" class="photo">
                    <div class="photo-caption">Birthday Baby 🎂</div>
                </div>
                <div class="photo-container">
                    <img src="liloandstich.jpg" alt="Lilo and Stitch" class="photo">
                    <div class="photo-caption">Lilo and Stitch Date 🏝️</div>
                </div>
                <div class="photo-container">
                    <img src="moana.jpg" alt="Moana" class="photo">
                    <div class="photo-caption">Moana Date 🌊</div>
                </div>
                <div class="photo-container">
                    <img src="swemmeng.jpg" alt="Swimming" class="photo">
                    <div class="photo-caption">Swimming Date 🏊‍♀️</div>
                </div>
                <div class="photo-container">
                    <img src="panaaddeyt.jpg" alt="Panaad Date" class="photo">
                    <div class="photo-caption">Panaad Date 🎪</div>
                </div>
                <div class="photo-container">
                    <img src="wickeddate.jpg" alt="Wicked Date" class="photo">
                    <div class="photo-caption">Wicked Date 🎭</div>
                </div>
                <div class="photo-container">
                    <img src="imartdate.jpg" alt="I-Mart Date" class="photo">
                    <div class="photo-caption">I-Mart Date 🛒</div>
                </div>
                <div class="photo-container">
                    <img src="randompic.jpg" alt="Random Picture" class="photo">
                    <div class="photo-caption">Random Picture 📸</div>
                </div>
                <div class="photo-container">
                    <img src="panaad.jpg" alt="Panaad" class="photo">
                    <div class="photo-caption">Panaad 🎪</div>
                </div>
                <div class="photo-container">
                    <img src="tncdate.jpg" alt="TNC Date" class="photo">
                    <div class="photo-caption">TNC Date 🎮</div>
                </div>
                <div class="photo-container">
                    <img src="walkingmegaworld.jpg" alt="Walking Megaworld" class="photo">
                    <div class="photo-caption">Walking Megaworld 🚶‍♀️</div>
                </div>
                <div class="photo-container">
                    <img src="captamericadate.jpg" alt="Captain America Date" class="photo">
                    <div class="photo-caption">Captain America Date 🛡️</div>
                </div>
                <div class="photo-container">
                    <img src="modernizedjeep.jpg" alt="Modernized Jeep" class="photo">
                    <div class="photo-caption">Modernized Jeep 🚌</div>
                </div>
                <div class="photo-container">
                    <img src="party2.jpg" alt="Party 2" class="photo">
                    <div class="photo-caption">Party Party 🎉</div>
                </div>
                <div class="photo-container">
                    <img src="twinning.jpg" alt="Twinning" class="photo">
                    <div class="photo-caption">Twinning 👯‍♀️</div>
                </div>
                <div class="photo-container">
                    <img src="jubogzsamcdo.jpg" alt="Jubogz Sam Cdo" class="photo">
                    <div class="photo-caption">Jubogz sa Mcdo 🍔</div>
                </div>
                <div class="photo-container">
                    <img src="tanglasapalmas.jpg" alt="Tanglasa Palmas" class="photo">
                    <div class="photo-caption">Tangla sa Palmas 🌴</div>
                </div>
                <div class="photo-container">
                    <img src="burgking.jpg" alt="Burger King" class="photo">
                    <div class="photo-caption">Burger King 🍔</div>
                </div>
                <div class="photo-container">
                    <img src="oneregis.jpg" alt="One Regis" class="photo">
                    <div class="photo-caption">One Regis 🏨</div>
                </div>
                <div class="photo-container">
                    <img src="f1movie.jpg" alt="F1 Movie" class="photo">
                    <div class="photo-caption">F1 Movie 🏎️</div>
                </div>
            </div>
        </section>
        
        <!-- Playlist Section -->
        <section class="card playlist fade-in">
            <h2>The Soundtrack of Our Love</h2>
            <div id="playlist-notes-container"></div>
            <iframe src="https://open.spotify.com/embed/playlist/3DZDE5FAX60IxBg5uO12SJ" width="100%" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
        </section>
        
        <!-- Countdown Timer Section -->
        <section class="card countdown fade-in">
            <h2>Until Our Next Monthsary</h2>
            <div class="timer-container">
                <div class="timer-item">
                    <span id="days" class="timer-value">0</span>
                    <span class="timer-label">Days</span>
                </div>
                <div class="timer-item">
                    <span id="hours" class="timer-value">0</span>
                    <span class="timer-label">Hours</span>
                </div>
                <div class="timer-item">
                    <span id="minutes" class="timer-value">0</span>
                    <span class="timer-label">Minutes</span>
                </div>
                <div class="timer-item">
                    <span id="seconds" class="timer-value">0</span>
                    <span class="timer-label">Seconds</span>
                </div>
            </div>
        </section>

        <!-- Love Quiz Section -->
        <section class="card love-quiz fade-in">
            <h2>How Well Do You Know Our Love? 💕</h2>
            <div class="quiz-container">
                <div class="quiz-question active" id="question-1">
                    <h3>Where was our first date?</h3>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">Jabee</div>
                        <div class="quiz-option" data-correct="false">SM City</div>
                        <div class="quiz-option" data-correct="false">Robinsons</div>
                        <div class="quiz-option" data-correct="false">Ayala</div>
                    </div>
                </div>
                <div class="quiz-question" id="question-2">
                    <h3>What's your favorite street food?</h3>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Fishball</div>
                        <div class="quiz-option" data-correct="true">Kwek-kwek</div>
                        <div class="quiz-option" data-correct="false">Taho</div>
                        <div class="quiz-option" data-correct="false">Balut</div>
                    </div>
                </div>
                <div class="quiz-question" id="question-3">
                    <h3>What do we call our special moments?</h3>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Date time</div>
                        <div class="quiz-option" data-correct="false">Love time</div>
                        <div class="quiz-option" data-correct="true">Date date</div>
                        <div class="quiz-option" data-correct="false">Sweet time</div>
                    </div>
                </div>
                <div class="quiz-result" id="quiz-result">
                    <h3>Quiz Complete! 🎉</h3>
                    <p>You got <span id="score">0</span> out of 3 questions correct!</p>
                    <p id="result-message">You're amazing! You know our love story perfectly! ❤️</p>
                    <button class="message-submit" onclick="restartQuiz()">Take Quiz Again</button>
                </div>
            </div>
        </section>
        
        <!-- Message Board Section -->
        <section class="card message-board fade-in">
            <h2>Our Private Message Board</h2>
            <div class="message-list" id="message-list">
                <div class="loading">Loading messages... 💕</div>
            </div>
            <div class="message-form">
                <input type="text" class="message-input" id="message-input" placeholder="Write a sweet note...">
                <button class="message-submit" id="message-submit">Send ❤️</button>
            </div>
        </section>

        <!-- Love Letters Archive Section -->
        <section class="card firebase-section fade-in">
            <h2>Our Love Letters Archive 💌</h2>
            
            <!-- Add New Letter Form -->
            <div class="add-letter-form">
                <h3 style="color: var(--primary-color); margin-bottom: 20px;">Add a New Love Letter</h3>
                <form id="add-letter-form">
                    <div class="form-group">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-input" id="letter-title" placeholder="Enter letter title..." required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Date</label>
                        <input type="date" class="form-input" id="letter-date" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Message</label>
                        <textarea class="form-input form-textarea" id="letter-message" placeholder="Write your love letter here..." required></textarea>
                    </div>
                    <button type="submit" class="form-submit" id="submit-letter">
                        <i class="fas fa-heart"></i> Save Love Letter
                    </button>
                </form>
            </div>

            <!-- Letters Archive -->
            <div class="letter-archive" id="letters-archive">
                <div class="loading">Loading love letters... 💕</div>
            </div>

            <!-- Add Open When Letter Form -->
            <div class="add-letter-form" style="margin-top: 40px;">
                <h3 style="color: var(--primary-color); margin-bottom: 20px;">🔮 Create a Custom "Open When..." Letter</h3>
                <form id="add-open-when-form">
                    <div class="form-group">
                        <label class="form-label">Trigger Type</label>
                        <select class="form-input" id="open-when-trigger" required>
                            <option value="">Select when this letter should be opened...</option>
                            <option value="sad">When you're sad 😢</option>
                            <option value="miss">When you miss me 💔</option>
                            <option value="birthday">On your birthday 🎂</option>
                            <option value="stressed">When you're stressed 😰</option>
                            <option value="happy">When you're happy 😊</option>
                            <option value="lonely">When you're lonely 🥺</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-input" id="open-when-title" placeholder="Enter letter title..." required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Message</label>
                        <textarea class="form-input form-textarea" id="open-when-message" placeholder="Write your special message here..." required></textarea>
                    </div>

                    <button type="submit" class="form-submit" id="submit-open-when">
                        <i class="fas fa-magic"></i> Create Special Letter
                    </button>
                </form>
            </div>
        </section>

        <!-- Quiz Scores Archive Section -->
        <section class="card firebase-section fade-in">
            <h2>Quiz Score History 📊</h2>
            <div class="quiz-scores" id="quiz-scores">
                <div class="loading">Loading quiz scores... 📈</div>
            </div>
        </section>

        <!-- Open When Letters Section -->
        <section class="card open-when-section fade-in">
            <h2>🔮 Open When... Letters</h2>
            <p style="font-size: 1.1rem; margin-bottom: 30px; color: var(--accent-color);">
                Special letters for special moments. Click when you need them most! 💕
            </p>
            
            <div class="open-when-buttons" id="open-when-buttons">
                <button class="open-when-btn" onclick="showOpenWhenLetter('sad')">
                    😢 Open when you're sad
                </button>
                <button class="open-when-btn" onclick="showOpenWhenLetter('miss')">
                    💔 Open when you miss me
                </button>
                <button class="open-when-btn" onclick="showOpenWhenLetter('birthday')">
                    🎂 Open on your birthday
                </button>
                <button class="open-when-btn" onclick="showOpenWhenLetter('stressed')">
                    😰 Open when you're stressed
                </button>
                <button class="open-when-btn" onclick="showOpenWhenLetter('happy')">
                    😊 Open when you're happy
                </button>
                <button class="open-when-btn" onclick="showOpenWhenLetter('lonely')">
                    🥺 Open when you're lonely
                </button>
            </div>
        </section>

        <!-- Open When Modal -->
        <div id="open-when-modal" class="open-when-modal">
            <div class="open-when-content">
                <span class="modal-close" onclick="closeOpenWhenModal()">&times;</span>
                <div id="modal-content">
                    <!-- Content will be loaded here -->
                </div>
            </div>
        </div>
        
        <div class="footer">
            With love, from my heart to yours. Happy Monthsary! ❤️
        </div>
    </div>

    <!-- Firebase Configuration -->
    <script>
        // Firebase configuration - REPLACE WITH YOUR OWN CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyB0zXIhyTIpgWlEpxlc4Cw1gg8k_2-_p90",
            authDomain: "lovey-31501.firebaseapp.com",
            projectId: "lovey-31501",
            storageBucket: "lovey-31501.firebasestorage.app",
            messagingSenderId: "1047730887494",
            appId: "1:1047730887494:web:c1b5db67bf9a4f04866347",
            measurementId: "G-3Z0E1J6J53"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Firebase Functions
        async function addLoveLetter(title, date, message) {
            try {
                console.log('Attempting to add love letter:', { title, date, message });
                
                const docRef = await db.collection('loveLetters').add({
                    title: title,
                    date: date,
                    message: message,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                console.log('Love letter added successfully with ID:', docRef.id);
                return true;
            } catch (error) {
                console.error('Error adding letter:', error);
                console.error('Error code:', error.code);
                console.error('Error message:', error.message);
                return false;
            }
        }

        async function getLoveLetters() {
            try {
                const snapshot = await db.collection('loveLetters')
                    .orderBy('timestamp', 'desc')
                    .get();
                
                const letters = [];
                snapshot.forEach(doc => {
                    letters.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                return letters;
            } catch (error) {
                console.error('Error getting letters:', error);
                return [];
            }
        }

        async function saveQuizScore(score, totalQuestions, message) {
            try {
                await db.collection('quizScores').add({
                    score: score,
                    totalQuestions: totalQuestions,
                    message: message,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                return true;
            } catch (error) {
                console.error('Error saving quiz score:', error);
                return false;
            }
        }

        // Message Board Firebase Functions
        async function addMessageToFirebase(messageText) {
            try {
                await db.collection('messages').add({
                    message: messageText,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                return true;
            } catch (error) {
                console.error('Error adding message:', error);
                return false;
            }
        }

        async function getMessages() {
            try {
                const snapshot = await db.collection('messages')
                    .orderBy('timestamp', 'desc')
                    .limit(50) // Limit to last 50 messages
                    .get();
                
                const messages = [];
                snapshot.forEach(doc => {
                    const data = doc.data();
                    messages.push({
                        id: doc.id,
                        message: data.message,
                        timestamp: data.timestamp ? data.timestamp.toDate() : new Date()
                    });
                });
                return messages;
            } catch (error) {
                console.error('Error getting messages:', error);
                return [];
            }
        }

        async function displayMessages() {
            const messageList = document.getElementById('message-list');
            messageList.innerHTML = '<div class="loading">Loading messages... 💕</div>';
            
            try {
                const messages = await getMessages();
                
                if (messages.length === 0) {
                    messageList.innerHTML = '<div class="message"><p>No messages yet. Be the first to write something sweet! 💕</p></div>';
                    return;
                }
                
                messageList.innerHTML = '';
                messages.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    messageDiv.classList.add('message');
                    
                    const timeString = msg.timestamp.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                    const dateString = msg.timestamp.toLocaleDateString();
                    
                    messageDiv.innerHTML = `
                        <p>${msg.message}</p>
                        <div class="message-time">${dateString}, ${timeString}</div>
                    `;
                    
                    messageList.appendChild(messageDiv);
                });
            } catch (error) {
                console.error('Error displaying messages:', error);
                messageList.innerHTML = '<div class="message"><p>Error loading messages. Please try again.</p></div>';
            }
        }

        async function getQuizScores() {
            try {
                const snapshot = await db.collection('quizScores')
                    .orderBy('timestamp', 'desc')
                    .get();
                
                const scores = [];
                snapshot.forEach(doc => {
                    scores.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                return scores;
            } catch (error) {
                console.error('Error getting quiz scores:', error);
                return [];
            }
        }

        async function deleteLoveLetter(letterId) {
            try {
                await db.collection('loveLetters').doc(letterId).delete();
                console.log('Love letter deleted successfully');
                return true;
            } catch (error) {
                console.error('Error deleting love letter:', error);
                return false;
            }
        }

        async function deleteQuizScore(scoreId) {
            try {
                await db.collection('quizScores').doc(scoreId).delete();
                console.log('Quiz score deleted successfully');
                return true;
            } catch (error) {
                console.error('Error deleting quiz score:', error);
                return false;
            }
        }

        async function addOpenWhenLetter(trigger, title, message) {
            try {
                await db.collection('openWhenLetters').doc(trigger).set({
                    title: title,
                    message: message,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                return true;
            } catch (error) {
                console.error('Error adding open when letter:', error);
                return false;
            }
        }

        async function getOpenWhenLetter(trigger) {
            try {
                const doc = await db.collection('openWhenLetters').doc(trigger).get();
                if (doc.exists) {
                    return doc.data();
                } else {
                    return null;
                }
            } catch (error) {
                console.error('Error getting open when letter:', error);
                return null;
            }
        }

        async function getAllOpenWhenLetters() {
            try {
                const snapshot = await db.collection('openWhenLetters').get();
                const letters = {};
                snapshot.forEach(doc => {
                    letters[doc.id] = doc.data();
                });
                return letters;
            } catch (error) {
                console.error('Error getting all open when letters:', error);
                return {};
            }
        }

        function displayLoveLetters(letters) {
            const archiveContainer = document.getElementById('letters-archive');
            
            if (letters.length === 0) {
                archiveContainer.innerHTML = '<div class="no-data">No love letters yet. Write your first one above! 💕</div>';
                return;
            }

            const lettersHTML = letters.map(letter => {
                const date = letter.date ? new Date(letter.date).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                }) : 'No date';
                
                return `
                    <div class="archive-letter">
                        <button class="delete-btn" onclick="deleteLetter('${letter.id}')" title="Delete this letter">
                            <i class="fas fa-trash"></i>
                        </button>
                        <div class="archive-letter-title">${letter.title}</div>
                        <div class="archive-letter-date">${date}</div>
                        <div class="archive-letter-message">${letter.message}</div>
                    </div>
                `;
            }).join('');

            archiveContainer.innerHTML = lettersHTML;
        }

        function displayQuizScores(scores) {
            const scoresContainer = document.getElementById('quiz-scores');
            
            if (scores.length === 0) {
                scoresContainer.innerHTML = '<div class="no-data">No quiz scores yet. Take the quiz above! 📝</div>';
                return;
            }

            const scoresHTML = scores.map(score => {
                const date = score.timestamp ? new Date(score.timestamp.toDate()).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                }) : 'No date';
                
                return `
                    <div class="score-item">
                        <button class="delete-btn" onclick="deleteScore('${score.id}')" title="Delete this score">
                            <i class="fas fa-trash"></i>
                        </button>
                        <div class="score-date">${date}</div>
                        <div class="score-value">${score.score}/${score.totalQuestions} correct</div>
                        <div class="score-message">${score.message}</div>
                    </div>
                `;
            }).join('');

            scoresContainer.innerHTML = scoresHTML;
        }

        // Load data on page load
        async function loadFirebaseData() {
            try {
                console.log('Testing Firebase connection...');
                
                // Test connection by trying to read from Firestore
                const testSnapshot = await db.collection('test').limit(1).get();
                console.log('Firebase connection successful!');
                
                // Load love letters
                const letters = await getLoveLetters();
                displayLoveLetters(letters);

                // Load quiz scores
                const scores = await getQuizScores();
                displayQuizScores(scores);

                // Load messages
                await displayMessages();
            } catch (error) {
                console.error('Firebase connection failed:', error);
                document.getElementById('letters-archive').innerHTML = 
                    '<div class="no-data">Firebase connection error: ' + error.message + '</div>';
                document.getElementById('quiz-scores').innerHTML = 
                    '<div class="no-data">Firebase connection error: ' + error.message + '</div>';
                document.getElementById('message-list').innerHTML = 
                    '<div class="no-data">Firebase connection error: ' + error.message + '</div>';
            }
        }

        // Add letter form handler - only add once
        let formHandlerAdded = false;
        let openWhenFormHandlerAdded = false;
        
        function setupFormHandler() {
            if (formHandlerAdded) return;
            
            const form = document.getElementById('add-letter-form');
            if (form) {
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = document.getElementById('submit-letter');
                    const originalText = submitBtn.innerHTML;
                    
                    // Prevent multiple submissions
                    if (submitBtn.disabled) return;
                    
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
                    
                    const title = document.getElementById('letter-title').value;
                    const date = document.getElementById('letter-date').value;
                    const message = document.getElementById('letter-message').value;
                    
                    try {
                        const success = await addLoveLetter(title, date, message);
                        
                        if (success) {
                            // Clear form
                            this.reset();
                            
                            // Set default date again after reset
                            setDefaultDate();
                            
                            // Reload letters
                            const letters = await getLoveLetters();
                            displayLoveLetters(letters);
                            
                            // Show success message
                            createConfetti();
                            
                            submitBtn.innerHTML = '<i class="fas fa-check"></i> Saved!';
                            setTimeout(() => {
                                submitBtn.disabled = false;
                                submitBtn.innerHTML = originalText;
                            }, 2000);
                        } else {
                            submitBtn.innerHTML = '<i class="fas fa-times"></i> Error!';
                            setTimeout(() => {
                                submitBtn.disabled = false;
                                submitBtn.innerHTML = originalText;
                            }, 2000);
                        }
                    } catch (error) {
                        console.error('Form submission error:', error);
                        submitBtn.innerHTML = '<i class="fas fa-times"></i> Error!';
                        setTimeout(() => {
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = originalText;
                        }, 2000);
                    }
                });
                
                formHandlerAdded = true;
            }
        }

        function setupOpenWhenFormHandler() {
            if (openWhenFormHandlerAdded) return;
            
            const form = document.getElementById('add-open-when-form');
            if (form) {
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = document.getElementById('submit-open-when');
                    const originalText = submitBtn.innerHTML;
                    
                    // Prevent multiple submissions
                    if (submitBtn.disabled) return;
                    
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating...';
                    
                    const trigger = document.getElementById('open-when-trigger').value;
                    const title = document.getElementById('open-when-title').value;
                    const message = document.getElementById('open-when-message').value;
                    
                    try {
                        const success = await addOpenWhenLetter(trigger, title, message);
                        
                        if (success) {
                            // Clear form
                            this.reset();
                            
                            // Show success message
                            createConfetti();
                            
                            submitBtn.innerHTML = '<i class="fas fa-check"></i> Created!';
                            setTimeout(() => {
                                submitBtn.disabled = false;
                                submitBtn.innerHTML = originalText;
                            }, 2000);
                        } else {
                            submitBtn.innerHTML = '<i class="fas fa-times"></i> Error!';
                            setTimeout(() => {
                                submitBtn.disabled = false;
                                submitBtn.innerHTML = originalText;
                            }, 2000);
                        }
                    } catch (error) {
                        console.error('Open When form submission error:', error);
                        submitBtn.innerHTML = '<i class="fas fa-times"></i> Error!';
                        setTimeout(() => {
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = originalText;
                        }, 2000);
                    }
                });
                
                openWhenFormHandlerAdded = true;
            }
        }

        // Set default date to today
        function setDefaultDate() {
            const dateInput = document.getElementById('letter-date');
            if (dateInput && !dateInput.value) {
                dateInput.valueAsDate = new Date();
            }
        }

        // Global delete functions
        async function deleteLetter(letterId) {
            if (confirm('Are you sure you want to delete this love letter? 💔')) {
                const success = await deleteLoveLetter(letterId);
                if (success) {
                    // Reload letters
                    const letters = await getLoveLetters();
                    displayLoveLetters(letters);
                    createConfetti(); // Celebrate the deletion
                } else {
                    alert('Failed to delete letter. Please try again.');
                }
            }
        }



        async function deleteScore(scoreId) {
            if (confirm('Are you sure you want to delete this quiz score? 📊')) {
                const success = await deleteQuizScore(scoreId);
                if (success) {
                    // Reload scores
                    const scores = await getQuizScores();
                    displayQuizScores(scores);
                    createConfetti(); // Celebrate the deletion
                } else {
                    alert('Failed to delete score. Please try again.');
                }
            }
        }

        // Open When Letters Functions
        async function showOpenWhenLetter(trigger) {
            const letter = await getOpenWhenLetter(trigger);
            const modal = document.getElementById('open-when-modal');
            const modalContent = document.getElementById('modal-content');
            
            if (letter) {
                modalContent.innerHTML = `
                    <div class="open-when-title">${letter.title}</div>
                    <div class="open-when-message">${letter.message}</div>
                `;
            } else {
                // Show default messages if no custom letter exists
                const defaultMessages = {
                    sad: {
                        title: "When You're Feeling Sad 💔",
                        message: "My dearest love,\n\nI wish I could be there right now to hold you close, wipe away your tears, and tell you everything will be okay. When you're sad, remember that you're not alone - I'm thinking of you every moment.\n\nYou are so incredibly strong, even when you don't feel like it. Your heart is beautiful and your spirit is unbreakable. This sadness is just a cloud passing by - the sun will shine again soon.\n\nTake care of yourself, my love. Rest if you need to, cry if you want to, and know that I'm sending you all my love and strength. You don't have to be strong all the time - it's okay to not be okay.\n\nYou are loved beyond measure, and you will get through this. I believe in you completely.\n\nRemember: You are worthy, you are enough, and you are so deeply loved.\n\n❤️ Forever yours"
                    },
                    miss: {
                        title: "When You Miss Me 💔",
                        message: "My beloved,\n\nI miss you too, more than you could ever know. Every moment we're apart feels like an eternity, but know that my heart is always with you. I think about you constantly - your smile, your laugh, the way you make me feel.\n\nDistance may separate us physically, but our love transcends any space between us. You're always in my thoughts and prayers.\n\nI can't wait to see you again and hold you in my arms.\n\nMissing you with all my heart,\nJames 💕"
                    },
                    birthday: {
                        title: "Happy Birthday, My Love! 🎂",
                        message: "Happy Birthday to the most amazing person in my life!\n\nToday is all about celebrating you - your beautiful soul, your kind heart, and the incredible person you are. You deserve all the happiness, love, and joy in the world.\n\nThank you for being born and for being the love of my life. You make every day feel like a celebration just by being you.\n\nI hope this year brings you everything you've ever dreamed of and more.\n\nHappy Birthday, my love!\n\nWith endless love,\nJames 🎉"
                    },
                    stressed: {
                        title: "When You're Feeling Stressed 😰",
                        message: "My love,\n\nI can feel that you're carrying a heavy burden right now, and I want you to know that it's okay to feel overwhelmed. You don't have to be strong all the time.\n\nTake a deep breath and remember that you're not alone. I'm here for you, always. You're doing amazing, and I'm so proud of you for handling everything with such grace.\n\nRemember to take care of yourself - you deserve peace and rest.\n\nI love you and I believe in you.\n\nWith love and support,\nJames 🌸"
                    },
                    happy: {
                        title: "When You're Happy 😊",
                        message: "My beautiful love,\n\nI'm so happy that you're happy! Your joy is contagious and it makes my heart overflow with love. Seeing you smile and hearing your laughter is the greatest gift in my life.\n\nYou deserve all the happiness in the world, and I'm grateful to be part of your journey. Your happiness is my happiness.\n\nKeep shining your beautiful light - the world is brighter because of you.\n\nCelebrating your joy with you,\nJames ✨"
                    },
                    lonely: {
                        title: "When You're Feeling Lonely 🥺",
                        message: "My dearest,\n\nI know that feeling of loneliness can be overwhelming, but please remember that you are never truly alone. My love for you is always there, surrounding you like a warm embrace.\n\nYou are so loved, so valued, and so important. Your presence in this world makes it a better place, and you bring so much light to my life.\n\nI'm thinking of you right now, sending you all my love and positive energy.\n\nYou are never alone, my love.\n\nWith all my love,\nJames 💝"
                    }
                };
                
                const defaultLetter = defaultMessages[trigger];
                modalContent.innerHTML = `
                    <div class="open-when-title">${defaultLetter.title}</div>
                    <div class="open-when-message">${defaultLetter.message}</div>
                `;
            }
            
            modal.style.display = 'block';
            createConfetti(); // Celebrate opening the letter
        }

        function closeOpenWhenModal() {
            const modal = document.getElementById('open-when-modal');
            modal.style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('open-when-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }


    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load Firebase data
            loadFirebaseData();
            
            // Setup form handlers and default date
            setupFormHandler();
            setupOpenWhenFormHandler();
            setDefaultDate();
            // Music Player Functionality
            const playPauseBtn = document.getElementById('play-pause-btn');
            const playIcon = document.getElementById('play-icon');
            const musicInfo = document.getElementById('music-info');
            let isPlaying = false;
            
            // Create audio element for background music
            // Local love song for a romantic scrolling experience
            const audio = new Audio('./lovesong.mp3'); // Your love song
            audio.loop = true;
            
            playPauseBtn.addEventListener('click', () => {
                if (isPlaying) {
                    audio.pause();
                    playIcon.className = 'fas fa-play';
                    musicInfo.textContent = 'Click to play our love song ❤️';
                    isPlaying = false;
                } else {
                    audio.play();
                    playIcon.className = 'fas fa-pause';
                    musicInfo.textContent = 'Playing: Our Love Song 💕';
                    isPlaying = true;
                }
            });

            // Create floating hearts
            const heartsContainer = document.getElementById('hearts-container');
            for (let i = 0; i < 20; i++) {
                createHeart();
            }
            
            function createHeart() {
                const heart = document.createElement('div');
                heart.classList.add('heart');
                
                // Random starting position
                const startPositionX = Math.random() * window.innerWidth;
                const startPositionY = Math.random() * window.innerHeight + window.innerHeight;
                
                heart.style.left = `${startPositionX}px`;
                heart.style.bottom = `-${Math.random() * 20}px`;
                
                // Random size
                const size = Math.random() * 20 + 10;
                heart.style.width = `${size}px`;
                heart.style.height = `${size}px`;
                
                // Random duration and delay
                const duration = Math.random() * 15 + 15;
                const delay = Math.random() * 15;
                
                heart.style.animationDuration = `${duration}s`;
                heart.style.animationDelay = `${delay}s`;
                
                heartsContainer.appendChild(heart);
                
                // Remove and recreate heart after animation ends
                setTimeout(() => {
                    heart.remove();
                    createHeart();
                }, (duration + delay) * 1000);
            }
            
            // Create floating music notes
            const playlistNotesContainer = document.getElementById('playlist-notes-container');
            for (let i = 0; i < 5; i++) {
                const note = document.createElement('div');
                note.classList.add('playlist-notes');
                
                // Random position
                note.style.left = `${Math.random() * 100}%`;
                note.style.top = `${Math.random() * 100}%`;
                
                // Random animation
                note.style.animation = `float ${Math.random() * 10 + 10}s infinite`;
                note.style.animationDelay = `${Math.random() * 5}s`;
                
                playlistNotesContainer.appendChild(note);
            }
            
            // Floating Love Messages
            const loveMessages = [
                "I love you more each day! ❤️",
                "You make my heart smile! 💕",
                "Every moment with you is precious! 🌹",
                "You're my favorite person! 💖",
                "Thank you for being you! ✨",
                "You're my dream come true! 💫",
                "I'm so lucky to have you! 🍀",
                "You're my everything! 💝"
            ];
            
            function showFloatingMessage() {
                const message = document.createElement('div');
                message.className = 'floating-message';
                message.textContent = loveMessages[Math.floor(Math.random() * loveMessages.length)];
                
                // Random position
                message.style.left = Math.random() * (window.innerWidth - 200) + 'px';
                message.style.top = Math.random() * (window.innerHeight - 100) + 'px';
                
                document.body.appendChild(message);
                
                // Remove after animation
                setTimeout(() => {
                    message.remove();
                }, 4000);
            }
            
            // Show floating message every 30 seconds
            setInterval(showFloatingMessage, 30000);
            
            // Confetti Function
            function createConfetti() {
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    
                    // Random position and color
                    confetti.style.left = Math.random() * window.innerWidth + 'px';
                    confetti.style.backgroundColor = ['#d1a080', '#8b5a2b', '#ff6b6b', '#4ecdc4', '#45b7d1'][Math.floor(Math.random() * 5)];
                    
                    // Random size
                    const size = Math.random() * 8 + 5;
                    confetti.style.width = size + 'px';
                    confetti.style.height = size + 'px';
                    
                    document.body.appendChild(confetti);
                    
                    // Remove after animation
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }
            }
            
            // Next Monthsary Countdown Timer
            function getNextMonthsary() {
                const today = new Date();
                const currentMonth = today.getMonth(); // 0-11 (January is 0)
                const currentYear = today.getFullYear();
                const currentDay = today.getDate();
                
                // Target the 7th of the next month
                let targetMonth = currentMonth;
                let targetYear = currentYear;
                
                // If today is past the 7th, move to the next month
                if (currentDay >= 7) {
                    targetMonth += 1;
                    if (targetMonth > 11) { // If December, roll over to January next year
                        targetMonth = 0;
                        targetYear += 1;
                    }
                }
                
                // Set the next monthsary to the 7th of the target month
                return new Date(targetYear, targetMonth, 7, 0, 0, 0);
            }
            
            function updateTimer() {
                const now = new Date();
                const nextMonthsary = getNextMonthsary();
                const timeLeft = nextMonthsary - now;
                
                if (timeLeft <= 0) {
                    // If the monthsary has arrived, show celebration message
                    document.querySelector('.timer-container').innerHTML = "<div class='letter-text' style='font-size: 2rem; color: var(--primary-color);'>Happy Monthsary, My Love! ❤️</div>";
                    createConfetti(); // Add confetti celebration
                    return;
                }
                
                const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = days;
                document.getElementById('hours').textContent = hours;
                document.getElementById('minutes').textContent = minutes;
                document.getElementById('seconds').textContent = seconds;
            }
            
            // Update timer every second
            setInterval(updateTimer, 1000);
            updateTimer(); // Initial call
            
            // Love Quiz Functionality
            let currentQuestion = 1;
            let score = 0;
            const totalQuestions = 3;
            
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', function() {
                    const isCorrect = this.getAttribute('data-correct') === 'true';
                    
                    if (isCorrect) {
                        this.classList.add('correct');
                        score++;
                    } else {
                        this.classList.add('incorrect');
                    }
                    
                    // Disable all options in current question
                    this.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                        opt.style.pointerEvents = 'none';
                    });
                    
                    // Move to next question after 1.5 seconds
                    setTimeout(() => {
                        if (currentQuestion < totalQuestions) {
                            document.getElementById(`question-${currentQuestion}`).classList.remove('active');
                            currentQuestion++;
                            document.getElementById(`question-${currentQuestion}`).classList.add('active');
                        } else {
                            // Show results
                            document.getElementById(`question-${currentQuestion}`).classList.remove('active');
                            document.getElementById('score').textContent = score;
                            
                            let resultMessage = '';
                            if (score === 3) {
                                resultMessage = "Perfect! You know our love story perfectly! ❤️";
                                createConfetti();
                            } else if (score === 2) {
                                resultMessage = "Great job! You really know us well! 💕";
                            } else if (score === 1) {
                                resultMessage = "Good try! Let's create more memories together! 🌹";
                            } else {
                                resultMessage = "Don't worry! We'll make more beautiful memories! 💖";
                            }
                            
                            document.getElementById('result-message').textContent = resultMessage;
                            document.getElementById('quiz-result').classList.add('show');
                            
                            // Save quiz score to Firebase
                            saveQuizScore(score, totalQuestions, resultMessage).then(success => {
                                if (success) {
                                    // Reload quiz scores
                                    getQuizScores().then(scores => {
                                        displayQuizScores(scores);
                                    });
                                }
                            });
                        }
                    }, 1500);
                });
            });
            
            // Restart Quiz Function
            window.restartQuiz = function() {
                currentQuestion = 1;
                score = 0;
                
                // Reset all questions
                document.querySelectorAll('.quiz-question').forEach(q => {
                    q.classList.remove('active');
                });
                document.getElementById('question-1').classList.add('active');
                
                // Reset all options
                document.querySelectorAll('.quiz-option').forEach(opt => {
                    opt.classList.remove('correct', 'incorrect');
                    opt.style.pointerEvents = 'auto';
                });
                
                // Hide results
                document.getElementById('quiz-result').classList.remove('show');
            };
            
            // Message Board Functionality
            const messageForm = document.getElementById('message-submit');
            const messageInput = document.getElementById('message-input');
            const messageList = document.getElementById('message-list');
            
            messageForm.addEventListener('click', addMessage);
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addMessage();
                }
            });
            
            async function addMessage() {
                const messageText = messageInput.value.trim();
                if (messageText) {
                    // Disable input and button while saving
                    messageInput.disabled = true;
                    messageForm.disabled = true;
                    const originalText = messageForm.textContent;
                    messageForm.textContent = 'Sending... 💕';
                    
                    try {
                        const success = await addMessageToFirebase(messageText);
                        
                        if (success) {
                            // Clear input
                            messageInput.value = '';
                            
                            // Reload messages to show the new one
                            await displayMessages();
                            
                            // Add confetti for special messages
                            if (messageText.toLowerCase().includes('love') || messageText.toLowerCase().includes('❤️')) {
                                createConfetti();
                            }
                            
                            // Show success feedback
                            messageForm.textContent = 'Sent! ❤️';
                            setTimeout(() => {
                                messageForm.textContent = originalText;
                            }, 1000);
                        } else {
                            alert('Failed to send message. Please try again.');
                            messageForm.textContent = 'Error! ❌';
                            setTimeout(() => {
                                messageForm.textContent = originalText;
                            }, 2000);
                        }
                    } catch (error) {
                        console.error('Error adding message:', error);
                        alert('Error sending message. Please try again.');
                        messageForm.textContent = 'Error! ❌';
                        setTimeout(() => {
                            messageForm.textContent = originalText;
                        }, 2000);
                    } finally {
                        // Re-enable input and button
                        messageInput.disabled = false;
                        messageForm.disabled = false;
                        messageInput.focus();
                    }
                }
            }
            
            // Add scroll reveal animation for elements
            const cards = document.querySelectorAll('.card');
            
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = 1;
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });
            
            cards.forEach(card => {
                observer.observe(card);
            });
            
            // Add click confetti effect
            document.addEventListener('click', function(e) {
                if (e.target.tagName === 'H1' || e.target.tagName === 'H2') {
                    createConfetti();
                }
            });
        });
    </script>
</body>
</html>
